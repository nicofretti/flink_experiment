package org.data.expo;

import org.apache.flink.streaming.api.windowing.triggers.TriggerResult;
import org.apache.flink.streaming.api.windowing.windows.Window;

import java.util.ArrayList;
import java.util.Arrays;

public class DataExpoDebug {
  /// Class to use during the development of the data expo project

  /// A list of a possible input
  static ArrayList<String> example =
      new ArrayList<>(
          Arrays.asList(
              "2005,1,28,5,1603.0,1605,1741.0,1759,UA,541,N935UA,158.0,174,131.0,-18.0,-2.0,BOS,ORD,867,4,23,0,0,0,0,0,0,0,0,1992",
              "2005,1,29,6,1559.0,1605,1736.0,1759,UA,541,N941UA,157.0,174,136.0,-23.0,-6.0,BOS,ORD,867,6,15,0,0,0,0,0,0,0,0,1992",
              "2005,1,30,7,1603.0,1610,1741.0,1805,UA,541,N342UA,158.0,175,131.0,-24.0,-7.0,BOS,ORD,867,9,18,0,0,0,0,0,0,0,0,1988",
              "2005,1,31,1,1556.0,1605,1726.0,1759,UA,541,N326UA,150.0,174,129.0,-33.0,-9.0,BOS,ORD,867,11,10,0,0,0,0,0,0,0,0,1988",
              "2005,1,2,7,1934.0,1900,2235.0,2232,UA,542,N902UA,121.0,152,106.0,3.0,34.0,ORD,BOS,867,5,10,0,0,0,0,0,0,0,0,1990",
              "2005,1,3,1,2042.0,1900,9.0,2232,UA,542,N904UA,147.0,152,97.0,97.0,102.0,ORD,BOS,867,3,47,0,0,0,23,0,0,0,74,1990",
              "2005,1,4,2,2046.0,1900,2357.0,2232,UA,542,N942UA,131.0,152,100.0,85.0,106.0,ORD,BOS,867,5,26,0,0,0,46,0,0,0,39,1992",
              "2005,1,5,3,0.0,1900,0.0,2232,UA,542,000000,0.0,152,0.0,0.0,0.0,ORD,BOS,867,0,0,1,B,0,0,0,0,0,0,0",
              "2005,1,6,4,2110.0,1900,8.0,2223,UA,542,N920UA,118.0,143,101.0,105.0,130.0,ORD,BOS,867,2,15,0,0,0,16,0,0,0,89,0",
              "2005,1,7,5,1859.0,1900,2235.0,2223,UA,542,N340UA,156.0,143,96.0,12.0,-1.0,ORD,BOS,867,4,56,0,0,0,0,0,0,0,0,1988",
              "2005,1,9,7,1859.0,1900,2205.0,2223,UA,542,N929UA,126.0,143,106.0,-18.0,-1.0,ORD,BOS,867,5,15,0,0,0,0,0,0,0,0,1992",
              "2005,1,10,1,1917.0,1900,2240.0,2223,UA,542,N934UA,143.0,143,116.0,17.0,17.0,ORD,BOS,867,3,24,0,0,0,17,0,0,0,0,1992",
              "2005,1,11,2,1935.0,1900,2259.0,2223,UA,542,N336UA,144.0,143,106.0,36.0,35.0,ORD,BOS,867,6,32,0,0,0,0,0,1,0,35,1988",
              "2005,1,12,3,2038.0,1900,18.0,2223,UA,542,N920UA,160.0,143,111.0,115.0,98.0,ORD,BOS,867,6,43,0,0,0,18,0,17,0,80,0",
              "2005,1,13,4,2106.0,1900,9.0,2223,UA,542,N923UA,123.0,143,106.0,106.0,126.0,ORD,BOS,867,6,11,0,0,0,13,0,0,0,93,1992",
              "2005,1,14,5,1919.0,1900,2228.0,2223,UA,542,N917UA,129.0,143,100.0,5.0,19.0,ORD,BOS,867,9,20,0,0,0,0,0,0,0,0,0",
              "2005,1,16,7,1911.0,1900,0.0,2223,UA,542,N348UA,0.0,143,0.0,0.0,11.0,ORD,BOS,867,0,13,0,0,1,0,0,0,0,0,1988",
              "2005,1,17,1,1859.0,1900,2202.0,2223,UA,542,N902UA,123.0,143,109.0,-21.0,-1.0,ORD,BOS,867,3,11,0,0,0,0,0,0,0,0,1990",
              "2005,1,18,2,1856.0,1900,2227.0,2223,UA,542,N906UA,151.0,143,117.0,4.0,-4.0,ORD,BOS,867,3,31,0,0,0,0,0,0,0,0,1991",
              "2005,1,19,3,1939.0,1900,2348.0,2223,UA,542,N932UA,189.0,143,166.0,85.0,39.0,ORD,BOS,867,6,17,0,0,0,10,0,46,0,29,1992",
              "2005,1,20,4,2128.0,1900,41.0,2223,UA,542,N910UA,133.0,143,111.0,138.0,148.0,ORD,BOS,867,4,18,0,0,0,32,0,0,0,106,1991",
              "2005,1,21,5,1913.0,1900,2226.0,2223,UA,542,N934UA,133.0,143,110.0,3.0,13.0,ORD,BOS,867,4,19,0,0,0,0,0,0,0,0,1992",
              "2005,1,23,7,0.0,1900,0.0,2223,UA,542,000000,0.0,143,0.0,0.0,0.0,ORD,BOS,867,0,0,1,B,0,0,0,0,0,0,0",
              "2005,1,24,1,0.0,1900,0.0,2223,UA,542,000000,0.0,143,0.0,0.0,0.0,ORD,BOS,867,0,0,1,A,0,0,0,0,0,0,0",
              "2005,1,25,2,1849.0,1900,2200.0,2223,UA,542,N929UA,131.0,143,108.0,-23.0,-11.0,ORD,BOS,867,4,19,0,0,0,0,0,0,0,0,1992",
              "2005,1,26,3,0.0,1900,0.0,2223,UA,542,000000,0.0,143,0.0,0.0,0.0,ORD,BOS,867,0,0,1,A,0,0,0,0,0,0,0",
              "2005,1,27,4,1859.0,1900,2215.0,2223,UA,542,N927UA,136.0,143,115.0,-8.0,-1.0,ORD,BOS,867,8,13,0,0,0,0,0,0,0,0,1992",
              "2005,1,28,5,1855.0,1900,2218.0,2223,UA,542,N923UA,143.0,143,111.0,-5.0,-5.0,ORD,BOS,867,7,25,0,0,0,0,0,0,0,0,1992",
              "2005,1,30,7,1858.0,1900,2212.0,2223,UA,542,N920UA,134.0,143,117.0,-11.0,-2.0,ORD,BOS,867,7,10,0,0,0,0,0,0,0,0,0",
              "2005,1,31,1,1858.0,1900,2215.0,2223,UA,542,N919UA,137.0,143,112.0,-8.0,-2.0,ORD,BOS,867,6,19,0,0,0,0,0,0,0,0,1991",
              "2005,1,1,6,1704.0,1715,1919.0,1915,UA,543,N203UA,195.0,180,144.0,4.0,-11.0,BOS,ORD,867,13,38,0,0,0,0,0,0,0,0,1990",
              "2005,1,2,7,1713.0,1715,1911.0,1915,UA,543,N392UA,178.0,180,140.0,-4.0,-2.0,BOS,ORD,867,18,20,0,0,0,0,0,0,0,0,0",
              "2005,1,3,1,1856.0,1715,2106.0,1915,UA,543,N916UA,190.0,180,158.0,111.0,101.0,BOS,ORD,867,8,24,0,0,0,0,0,111,0,0,0",
              "2005,1,4,2,1744.0,1715,1950.0,1915,UA,543,N927UA,186.0,180,167.0,35.0,29.0,BOS,ORD,867,5,14,0,0,0,0,0,35,0,0,1992",
              "2005,1,5,3,0.0,1715,0.0,1915,UA,543,000000,0.0,180,0.0,0.0,0.0,BOS,ORD,867,0,0,1,B,0,0,0,0,0,0,0",
              "2005,1,6,4,2046.0,1705,2221.0,1902,UA,543,N342UA,155.0,177,135.0,199.0,221.0,BOS,ORD,867,6,14,0,0,0,0,0,199,0,0,1988",
              "2005,1,7,5,1704.0,1705,1926.0,1902,UA,543,N312UA,202.0,177,152.0,24.0,-1.0,BOS,ORD,867,16,34,0,0,0,0,0,24,0,0,1987",
              "2005,1,9,7,1853.0,1705,2138.0,1902,UA,543,N326UA,225.0,177,169.0,156.0,108.0,BOS,ORD,867,4,52,0,0,0,0,0,156,0,0,1988",
              "2005,1,10,1,1703.0,1705,1906.0,1902,UA,543,N912UA,183.0,177,167.0,4.0,-2.0,BOS,ORD,867,4,12,0,0,0,0,0,0,0,0,1991",
              "2005,1,11,2,1748.0,1705,1945.0,1902,UA,543,N348UA,177.0,177,156.0,43.0,43.0,BOS,ORD,867,5,16,0,0,0,0,0,0,0,43,1988",
              "2005,1,12,3,0.0,1705,0.0,1902,UA,543,000000,0.0,177,0.0,0.0,0.0,BOS,ORD,867,0,0,1,C,0,0,0,0,0,0,0",
              "2005,1,13,4,1856.0,1705,2048.0,1902,UA,543,N203UA,172.0,177,146.0,106.0,111.0,BOS,ORD,867,3,23,0,0,0,0,0,72,0,34,1990",
              "2005,1,14,5,1712.0,1705,1919.0,1902,UA,543,N326UA,187.0,177,154.0,17.0,7.0,BOS,ORD,867,9,24,0,0,0,7,0,10,0,0,1988",
              "2005,1,16,7,1655.0,1705,1916.0,1902,UA,543,N363UA,201.0,177,144.0,14.0,-10.0,BOS,ORD,867,6,51,0,0,0,0,0,0,0,0,0",
              "2005,1,17,1,1704.0,1705,1857.0,1902,UA,543,N333UA,173.0,177,141.0,-5.0,-1.0,BOS,ORD,867,10,22,0,0,0,0,0,0,0,0,1988",
              "2005,1,18,2,1657.0,1705,1846.0,1902,UA,543,N349UA,169.0,177,141.0,-16.0,-8.0,BOS,ORD,867,9,19,0,0,0,0,0,0,0,0,1988",
              "2005,1,19,3,1809.0,1705,2028.0,1902,UA,543,N343UA,199.0,177,133.0,86.0,64.0,BOS,ORD,867,4,62,0,0,0,0,0,86,0,0,0",
              "2005,1,20,4,1923.0,1705,2112.0,1902,UA,543,N347UA,169.0,177,141.0,130.0,138.0,BOS,ORD,867,5,23,0,0,0,0,0,128,0,2,1988",
              "2005,1,21,5,1716.0,1705,1916.0,1902,UA,543,N398UA,180.0,177,151.0,14.0,11.0,BOS,ORD,867,10,19,0,0,0,0,0,0,0,0,1990",
              "2005,1,23,7,0.0,1705,0.0,1902,UA,543,000000,0.0,177,0.0,0.0,0.0,BOS,ORD,867,0,0,1,B,0,0,0,0,0,0,0",
              "2005,1,24,1,1744.0,1705,1935.0,1902,UA,543,N921UA,171.0,177,135.0,33.0,39.0,BOS,ORD,867,8,28,0,0,0,0,0,33,0,0,1991",
              "2005,1,25,2,1726.0,1705,1923.0,1902,UA,543,N330UA,177.0,177,145.0,21.0,21.0,BOS,ORD,867,6,26,0,0,0,21,0,0,0,0,1988",
              "2005,1,26,3,0.0,1705,0.0,1902,UA,543,000000,0.0,177,0.0,0.0,0.0,BOS,ORD,867,0,0,1,B,0,0,0,0,0,0,0",
              "2005,1,27,4,1711.0,1705,1900.0,1902,UA,543,N203UA,169.0,177,137.0,-2.0,6.0,BOS,ORD,867,15,17,0,0,0,0,0,0,0,0,1990",
              "2005,1,28,5,1706.0,1705,1843.0,1902,UA,543,N314UA,157.0,177,132.0,-19.0,1.0,BOS,ORD,867,4,21,0,0,0,0,0,0,0,0,1987",
              "2005,1,30,7,1657.0,1705,1826.0,1902,UA,543,N338UA,149.0,177,133.0,-36.0,-8.0,BOS,ORD,867,4,12,0,0,0,0,0,0,0,0,1988",
              "2005,1,31,1,1658.0,1705,1827.0,1902,UA,543,N340UA,149.0,177,130.0,-35.0,-7.0,BOS,ORD,867,5,14,0,0,0,0,0,0,0,0,1988",
              "2005,1,6,4,2323.0,1950,221.0,2250,UA,543,N342UA,178.0,180,163.0,211.0,213.0,ORD,SAT,1041,3,12,0,0,0,27,0,0,0,184,1988",
              "2005,1,7,5,2012.0,1950,2325.0,2250,UA,543,N312UA,193.0,180,155.0,35.0,22.0,ORD,SAT,1041,3,35,0,0,0,11,0,13,0,11,1987",
              "2005,1,8,6,1949.0,1950,2242.0,2250,UA,543,N203UA,173.0,180,156.0,-8.0,-1.0,ORD,SAT,1041,3,14,0,0,0,0,0,0,0,0,1990",
              "2005,1,9,7,2205.0,1950,133.0,2250,UA,543,N326UA,208.0,180,164.0,163.0,135.0,ORD,SAT,1041,4,40,0,0,0,0,0,28,0,135,1988",
              "2005,1,10,1,2049.0,1950,2340.0,2250,UA,543,N312UA,171.0,180,153.0,50.0,59.0,ORD,SAT,1041,4,14,0,0,0,0,0,0,0,50,1987",
              "2005,1,11,2,2033.0,1950,2344.0,2250,UA,543,N348UA,191.0,180,163.0,54.0,43.0,ORD,SAT,1041,3,25,0,0,0,13,0,11,0,30,1988",
              "2005,1,12,3,2027.0,1950,6.0,2250,UA,543,N346UA,219.0,180,171.0,76.0,37.0,ORD,SAT,1041,3,45,0,0,0,37,0,39,0,0,1988",
              "2005,1,13,4,2144.0,1950,36.0,2250,UA,543,N203UA,172.0,180,150.0,106.0,114.0,ORD,SAT,1041,5,17,0,0,0,20,0,0,0,86,1990",
              "2005,1,14,5,2042.0,1950,2335.0,2250,UA,543,N326UA,173.0,180,158.0,45.0,52.0,ORD,SAT,1041,3,12,0,0,0,42,0,0,0,3,1988",
              "2005,1,15,6,1949.0,1950,2233.0,2250,UA,543,N318UA,164.0,180,149.0,-17.0,-1.0,ORD,SAT,1041,3,12,0,0,0,0,0,0,0,0,1988",
              "2005,1,16,7,2018.0,1950,2353.0,2250,UA,543,N309UA,215.0,180,158.0,63.0,28.0,ORD,SAT,1041,5,52,0,0,0,6,0,35,0,22,1987",
              "2005,1,17,1,1949.0,1950,2246.0,2250,UA,543,N333UA,177.0,180,155.0,-4.0,-1.0,ORD,SAT,1041,4,18,0,0,0,0,0,0,0,0,1988",
              "2005,1,18,2,1948.0,1950,2247.0,2250,UA,543,N349UA,179.0,180,145.0,-3.0,-2.0,ORD,SAT,1041,4,30,0,0,0,0,0,0,0,0,1988",
              "2005,1,19,3,2124.0,1950,2358.0,2250,UA,543,N343UA,154.0,180,134.0,68.0,94.0,ORD,SAT,1041,3,17,0,0,0,15,0,0,0,53,0",
              "2005,1,20,4,2205.0,1950,40.0,2250,UA,543,N347UA,155.0,180,139.0,110.0,135.0,ORD,SAT,1041,3,13,0,0,0,15,0,0,0,95,1988",
              "2005,1,21,5,0.0,1950,0.0,2250,UA,543,000000,0.0,180,0.0,0.0,0.0,ORD,SAT,1041,0,0,1,B,0,0,0,0,0,0,0",
              "2005,1,22,6,2128.0,1950,15.0,2250,UA,543,N310UA,167.0,180,138.0,85.0,98.0,ORD,SAT,1041,5,24,0,0,0,27,0,0,0,58,1987",
              "2005,1,23,7,2104.0,1950,2347.0,2250,UA,543,N315UA,163.0,180,137.0,57.0,74.0,ORD,SAT,1041,4,22,0,0,0,57,0,0,0,0,1987",
              "2005,1,24,1,2028.0,1950,2305.0,2250,UA,543,N921UA,157.0,180,143.0,15.0,38.0,ORD,SAT,1041,2,12,0,0,0,7,0,0,0,8,1991",
              "2005,1,25,2,2002.0,1950,2244.0,2250,UA,543,N330UA,162.0,180,140.0,-6.0,12.0,ORD,SAT,1041,4,18,0,0,0,0,0,0,0,0,1988",
              "2005,1,26,3,2020.0,1950,2254.0,2250,UA,543,N313UA,154.0,180,136.0,4.0,30.0,ORD,SAT,1041,2,16,0,0,0,0,0,0,0,0,1987",
              "2005,1,27,4,2012.0,1950,2314.0,2250,UA,543,N203UA,182.0,180,154.0,24.0,22.0,ORD,SAT,1041,5,23,0,0,0,22,0,2,0,0,1990",
              "2005,1,28,5,1952.0,1950,2257.0,2250,UA,543,N381UA,185.0,180,158.0,7.0,2.0,ORD,SAT,1041,3,24,0,0,0,0,0,0,0,0,1990",
              "2005,1,29,6,1948.0,1950,2246.0,2250,UA,543,N311UA,178.0,180,158.0,-4.0,-2.0,ORD,SAT,1041,3,17,0,0,0,0,0,0,0,0,1987",
              "2005,1,30,7,1946.0,1950,2258.0,2250,UA,543,N338UA,192.0,180,176.0,8.0,-4.0,ORD,SAT,1041,4,12,0,0,0,0,0,0,0,0,1988",
              "2005,1,31,1,1948.0,1950,2253.0,2250,UA,543,N340UA,185.0,180,165.0,3.0,-2.0,ORD,SAT,1041,6,14,0,0,0,0,0,0,0,0,1988",
              "2005,1,1,6,2220.0,2045,119.0,2359,UA,544,N325UA,119.0,134,103.0,80.0,95.0,ORD,BOS,867,2,14,0,0,0,58,0,0,0,22,1988",
              "2005,1,2,7,2119.0,2045,15.0,2359,UA,544,N325UA,116.0,134,103.0,16.0,34.0,ORD,BOS,867,5,8,0,0,0,13,0,0,0,3,1988",
              "2005,1,3,1,2221.0,2045,119.0,2359,UA,544,N908UA,118.0,134,97.0,80.0,96.0,ORD,BOS,867,3,18,0,0,0,0,0,0,0,80,0",
              "2005,1,4,2,2233.0,2045,130.0,2359,UA,544,N903UA,117.0,134,98.0,91.0,108.0,ORD,BOS,867,3,16,0,0,0,0,17,0,0,74,1990",
              "2005,1,5,3,2224.0,2045,131.0,2359,UA,544,N323UA,127.0,134,100.0,92.0,99.0,ORD,BOS,867,3,24,0,0,0,57,0,0,0,35,0",
              "2005,1,6,4,2119.0,2045,41.0,2359,UA,544,N855UA,142.0,134,100.0,42.0,34.0,ORD,BOS,867,11,31,0,0,0,0,0,8,0,34,2002",
              "2005,1,7,5,2235.0,2045,147.0,2359,UA,544,N839UA,132.0,134,96.0,108.0,110.0,ORD,BOS,867,6,30,0,0,0,19,0,0,0,89,2001",
              "2005,1,8,6,2045.0,2045,2354.0,2359,UA,544,N405UA,129.0,134,103.0,-5.0,0.0,ORD,BOS,867,7,19,0,0,0,0,0,0,0,0,1993",
              "2005,1,9,7,2200.0,2045,109.0,2359,UA,544,N433UA,129.0,134,97.0,70.0,75.0,ORD,BOS,867,4,28,0,0,0,20,0,0,0,50,1996",
              "2005,1,10,1,2054.0,2045,2343.0,2359,UA,544,N822UA,109.0,134,97.0,-16.0,9.0,ORD,BOS,867,2,10,0,0,0,0,0,0,0,0,1998",
              "2005,1,11,2,2130.0,2045,37.0,2359,UA,544,N817UA,127.0,134,103.0,38.0,45.0,ORD,BOS,867,4,20,0,0,0,0,0,0,0,38,1998",
              "2005,1,12,3,2206.0,2045,106.0,2359,UA,544,N835UA,120.0,134,99.0,67.0,81.0,ORD,BOS,867,6,15,0,0,0,67,0,0,0,0,2001",
              "2005,1,13,4,2223.0,2045,126.0,2359,UA,544,N801UA,123.0,134,103.0,87.0,98.0,ORD,BOS,867,7,13,0,0,0,0,0,0,0,87,1997",
              "2005,1,14,5,2141.0,2045,35.0,2359,UA,544,N806UA,114.0,134,98.0,36.0,56.0,ORD,BOS,867,2,14,0,0,0,19,0,0,0,17,1998",
              "2005,1,15,6,2044.0,2045,1.0,2359,UA,544,N402UA,137.0,134,105.0,2.0,-1.0,ORD,BOS,867,7,25,0,0,0,0,0,0,0,0,1993",
              "2005,1,16,7,2104.0,2045,36.0,2359,UA,544,N811UA,152.0,134,111.0,37.0,19.0,ORD,BOS,867,9,32,0,0,0,19,0,18,0,0,1998",
              "2005,1,17,1,2051.0,2045,2356.0,2359,UA,544,N817UA,125.0,134,102.0,-3.0,6.0,ORD,BOS,867,4,19,0,0,0,0,0,0,0,0,1998"));

  // Trigger for the windows that count the number element in the window and when the max is
  // reached, it will trigger
  // the window
  static class CountTrigger<T>
      extends org.apache.flink.streaming.api.windowing.triggers.Trigger<T, Window> {
    private final int max;
    private int count_occurrences = 0;

    public CountTrigger(int count) {
      this.max = count;
    }

    @Override
    public TriggerResult onElement(T element, long timestamp, Window window, TriggerContext ctx) {
      count_occurrences++;
      System.out.println(count_occurrences + " " + element.toString());
      if (count_occurrences >= max) {
        count_occurrences = 0;
        return TriggerResult.FIRE_AND_PURGE;
      }
      return TriggerResult.CONTINUE;
    }

    @Override
    public TriggerResult onProcessingTime(long time, Window window, TriggerContext ctx) {
      return TriggerResult.CONTINUE;
    }

    @Override
    public TriggerResult onEventTime(long time, Window window, TriggerContext ctx) {
      return TriggerResult.CONTINUE;
    }

    @Override
    public void clear(Window window, TriggerContext ctx) {}
  }
}
